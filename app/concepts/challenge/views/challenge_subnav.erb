<!-- sub-nav bar -->
<div class="sub-nav-bar sticky-top">
  <div class="container-fluid">
    <ul class="nav">
      <li class="nav-item">
        <%= link_to 'Overview', challenge_path(challenge), class: tab_class('overview') + " nav-link-01", "data-turbolinks": false %>
      </li>
      <% unless challenge.challenge_rounds.none? || !challenge.show_leaderboard && !(current_participant.admin? || challenge.organizer_id == current_participant.organizer_id) %>
        <li class="nav-item">
          <%= link_to 'Leaderboard', challenge_leaderboards_path(challenge), class: tab_class('leaderboard') + " nav-link-02", "data-turbolinks": false %>
        </li>
      <% end %>
      <li class="nav-item">
        <%= link_to 'Discussion', URI.escape(File.join(ENV['DISCOURSE_DOMAIN_NAME'], 'c', challenge.slug)),
          class: tab_class('discussion') + " nav-link-03" %>
      </li>
      <% if clef_task.present? %>
        <li class="nav-item"><%= link_to 'Dataset', clef_task_task_dataset_files_path(clef_task, challenge_id: challenge.id), class: tab_class('dataset') + " nav-link-04", "data-turbolinks": false %></li>
      <% else %>
        <li class="nav-item"><%= link_to 'Dataset', challenge_dataset_files_path(challenge), class: tab_class('dataset') + " nav-link-04", "data-turbolinks": false %></li>
      <% end %>

      <% if challenge.submissions_page.present? || current_participant.admin? || challenge.organizer_id == current_participant.organizer_id %>
        <li class="nav-item"><%= link_to 'Submissions', challenge_submissions_path(challenge), class: tab_class('submissions') + " nav-link-05", "data-turbolinks": false %></li>
      <% end %>

      <% if policy(challenge).edit? %>
        <% if challenge.clef_task #&& challenge.clef_task.eua_required? %>
          <li class="nav-item"><%= link_to 'Participants', challenge_clef_task_path(challenge), class: "nav-link nav-link-07", "data-turbolinks": false %></li>
        <% else %>
          <li class="nav-item"><%= link_to 'Participants', challenge_participant_challenges_path(challenge), class: "nav-link nav-link-07", "data-turbolinks": false %></li>
        <% end %>
      <% end %>
      <% if challenge.winners_tab_active.present? %>
        <li class="nav-item" ><%= link_to 'Winner', challenge_winners_path(challenge), class: "nav-link nav-link-07", "data-turbolinks": false %></li>
      <% end %>
      <% if challenge.dynamic_content_tab.present? %>
        <li class="nav-item" ><%= link_to challenge.dynamic_content_tab, challenge_dynamic_contents_path(challenge), class: "nav-link nav-link-08", "data-turbolinks": false%></li>
      <% end %>

      <!-- more dropdown md -->
      <% if !challenge_participant or !challenge_participant.accepted_dataset_toc %>
      <li class="nav-item dropdown more-md">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false"><svg width="16" height="4" xmlns="http://www.w3.org/2000/svg"><path d="M2 0C.9 0 0 .9 0 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zM8 0C6.9 0 6 .9 6 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z" fill="#5D5F60" fill-rule="nonzero"/></svg></a>
        <div class="dropdown-menu dropdown-menu-right">
              <%= link_to "Participate", challenge_participation_terms_path(challenge), { :class=>"dropdown-item strong" } %>
        </div>
      </li>
      <% end %>
      <!-- /more dropdown md -->

      <!-- more dropdown sm -->
      <li class="nav-item dropdown more-sm">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false"><svg width="16" height="4" xmlns="http://www.w3.org/2000/svg"><path d="M2 0C.9 0 0 .9 0 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zM8 0C6.9 0 6 .9 6 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z" fill="#5D5F60" fill-rule="nonzero"/></svg></a>
        <div class="dropdown-menu dropdown-menu-right">
          <a class="dropdown-item" href="#">Submissions</a>
          <% if !challenge_participant or !challenge_participant.accepted_dataset_toc %>
            <div class="dropdown-divider"></div>
            <%= link_to "Participate", challenge_participation_terms_path(challenge), { :class=>"dropdown-item strong" } %>
          <% end %>
        </div>
      </li>
      <!-- /more dropdown sm -->

      <!-- more dropdown xs -->
      <li class="nav-item dropdown more-xs">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false"><svg width="16" height="4" xmlns="http://www.w3.org/2000/svg"><path d="M2 0C.9 0 0 .9 0 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zM8 0C6.9 0 6 .9 6 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z" fill="#5D5F60" fill-rule="nonzero"/></svg></a>
        <div class="dropdown-menu dropdown-menu-right">
          <a class="dropdown-item" href="#">Discussion</a>
          <a class="dropdown-item" href="#">Dataset</a>
          <a class="dropdown-item" href="#">Submissions</a>
          <% if !challenge_participant or !challenge_participant.accepted_dataset_toc %>
            <div class="dropdown-divider"></div>
            <%= link_to "Participate", challenge_participation_terms_path(challenge), { :class=>"dropdown-item strong" } %>
          <% end %></div>
      </li>
      <!-- /more dropdown xs -->
    </ul>

    <% if policy(challenge).edit? %>
        <%= link_to edit_organizer_challenge_path(challenge.organizer,challenge), title: "Edit challenge", data: { turbolinks: false } do %>
        <button class="btn btn-secondary btn-sm" role="button">Edit Challenge</button>
      <% end %>
    <%else %>
      <% if !challenge_participant or !challenge_participant.accepted_dataset_toc %>
        <%= link_to "Participate", challenge_participation_terms_path(challenge), { :class=>"btn btn-primary" } %>
      <% end %>
    <% end %>
  </div>
</div>
<!-- /sub-nav bar -->
