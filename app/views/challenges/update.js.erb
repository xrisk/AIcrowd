function handleChallengeUpdate() {
  const challengeForWrapper  = document.getElementById('challenges-form__wrapper');
  const flashMessagesWrapper = document.getElementById('flash-messages-wrapper');
  const currentUrl           = new URL(window.location);
  const currentTab           = currentUrl.searchParams.get('step');
  const updateSuccessful     = "<%= @challenge.errors.none? %>";

  window.history.pushState(null, null, currentUrl.toString());

  window.scrollTo(0, 0);

  // Show alert and correct tab after scrolling is completed
  setTimeout(function() {
    challengeForWrapper.innerHTML = "<%= j render 'challenges/form', challenge: @challenge, challenge_rounds: @challenge_rounds %>";

    if (currentTab) {
      // Active tabs are disabled, thus I need to make it inactive to make it work
      $(`#challenge-edit-${currentTab}-tab`).removeClass('active');
      $(`#challenge-edit-${currentTab}-tab`).tab('show');
    }

    if (updateSuccessful === 'true') {
      $('.select2').select2();
      flashMessagesWrapper.innerHTML = "<%= j render 'layouts/flash_message', type: 'notice', message: 'Challenge updated.' %>";
    } else {
      flashMessagesWrapper.innerHTML = "<%= j render 'layouts/flash_message', type: 'error', message: 'This tab couldn\'t be saved because of errors. Please correct them.' %>";
    }
  }, window.pageYOffset / 4);
}

handleChallengeUpdate();
